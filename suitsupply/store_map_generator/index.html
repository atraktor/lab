<!DOCTYPE html>
<html>
<head>
  <title>Suitsupply Stores map generator</title>

  <script type="text/javascript" src="node_modules/jquery/dist/jquery.min.js"></script>
  <script type="text/javascript">

    (function($) {

      var gMapsAPI = 'https://maps.googleapis.com/maps/api/staticmap?maptype=roadmap',
      gMapsOptions =
      {
        zoom: 15,
        size: '420x160',
        scale: 2
      },
      gMapsParams = [],
      markerURL = 'http%3A%2F%2Fgoo.gl%2FJhVos6',
      apiKey = '',
      images = [],
      count = 5;

      $.each(gMapsOptions, function(key,val) {
        var optionSet = key + '=' + val;
        gMapsParams.push(optionSet);
      });
      gMapsParams = '&' + gMapsParams.join('&');

      var jqxhr = $.getJSON( 'stores.json', function(data) {

        $('form').submit(function( event ) {
          event.preventDefault();
          apiKey = $('input[type=text]').val();
          count = $('input[type=number').val();

          $('#images').empty();

          $.each(data, function(key,val) {
            if (key > count - 1) { return };
            var address = val.Address.split(' ').join('+'),
            city = val.Coordinates.split(' ').join('+');
            coordinates = address + '+' + city,
            name = coordinates.split('+').join(''),
            gMapsImgURL = '',
            markers = '&markers=size:tiny%7Cicon:http%3A%2F%2Flab.nolten.co%2Fsuitsupply%2Fglp_v3b.framer%2Fimages%2Fgarmentors%2Fyou.png%7C' + coordinates;

            if (coordinates.indexOf('_') != -1) { return };

            gMapsImgURL = gMapsAPI + '&center=' + coordinates + gMapsParams + markers + '&key=' + apiKey;

            $('#images').delay(2000).append('<h1>' + val.Address + ' ' + val.Coordinates + '</h1><a href="' + gMapsImgURL + '" download="hoi"><img src="' + gMapsImgURL + '" width="630" height="240"/></a>');

          });

        });

      });

    })(jQuery);

  </script>
  <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300" rel="stylesheet">
  <style type="text/css">
    body {
      font-family: "Roboto Condensed";
      font-weight: 300;
    }
    input {
      font-size: 1.5em;
      padding: 0.5em;
    }
    a {
      display: block;
      margin-bottom: 4em;
    }
  </style>
</head>
<body>

  <form>
    <input type="text" name="Google Maps API key" placeholder="Your API key please">
    <input type="number" name="count" placeholder="How many maps">
    <input type="submit" value="Generate those maps!">
  </form>

  <div id="images"></div>
  
</body>
</html>